I hope this email finds you well. I wanted to provide an update on the various options we have explored for automating the execution of a PowerShell script that copies data from SharePoint to our group network share. Below are the details of each option we have considered:Option 1: Azure Automation RunbookInitial Suggestion: This was our initial solution.Limitations: Azure Automation accounts have outbound connections that are public by default and cannot resolve internal names or connect to our internal services. Additionally, there is no option to integrate Azure Automation with Virtual Networks (VNets).Option 2: Running the Script from Azure Function AppsAdvantages: Azure Function Apps provide an option to integrate with VNets in Premium and Dedicated plans, allowing them to resolve internal names and connect to internal services.Requirements: To authenticate with the group network share using a service account, it is necessary to map it using the New-PSDrive cmdlet in PowerShell.Current Status: I am currently consulting with Steve Haber to determine if there is a way to authenticate to the group share without requiring the mapping to a function.Option 3: GitLab Windows Shared RunnersLimitations: GitLab Shared Runners require additional configuration, such as providing access to network mapping drives and making network configuration changes, which are not supported by the shared runners.Option 4: Running the Script on an Azure VMInterim Solution: As a tactical solution, we can spin up a Windows VM, schedule it to start over the weekends, execute the PowerShell script as a startup script, and then schedule an automatic shutdown once the script completes.I am continuing to explore these options and will keep you updated on any further developments. If you have any questions or require additional information, please do not hesitate to reach out.
